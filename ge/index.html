<html>
<head>
  <title>uCORE</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="http://skawaii.net/extjs/latest/resources/css/ext-all.css"/>
  <script type="text/javascript" src="http://skawaii.net/extjs/latest/adapter/ext/ext-base.js"></script>
  <script type="text/javascript" src="http://skawaii.net/extjs/latest/ext-all-debug.js"></script>
  <link rel="stylesheet" type="text/css" href="Ext.ux.GEarthPanel-1.1.css" />
  <script src="http://www.google.com/jsapi?key=ABQIAAAAtuDq1IioWnrYLMDZJXDaeBQtbCeXV1AaC_9GYwinjG7jMEsspxSTIxD1kpEv2TI4AyMEOkPYRiTVPQ"></script>
  <script type="text/javascript" src="Ext.ux.GEarthPanel-1.1.js"></script>

  <script type="text/javascript">
    google.load("earth", "1");
    //google.load("maps", "2.xx");

    Ext.onReady(function() {
      // Create Google Earth panel
      var earthPanel = new Ext.ux.GEarthPanel({
        region: 'center',
        contentEl: 'centerPanel',
        margins: '5 5 5 0',
        earthLayers: {
          LAYER_BORDERS: true,
          LAYER_ROADS: false,
          LAYER_BUILDINGS: false,
          LAYER_TERRAIN: true
        },
        earthOptions: {
          setStatusBarVisibility: true,
          setGridVisibility: false,
          setOverviewMapVisibility: false,
          setScaleLegendVisibility: false,
          setAtmosphereVisibility: true,
          setMouseNavigationEnabled: true
        }
      });

      // Create control panel
      var controlPanel = new Ext.Panel({
        region: 'west',
        contentEl: 'westPanel',
        title: 'Control Panel',
        width: 280,
        border: true,
        collapsible: true,
        margins: '5 5 5 5',
        layout: 'accordion',
        layoutConfig: {
          animate: true
        },
        defaultType: 'panel',
        defaults: {
          bodyStyle: 'padding: 10px'
        }
      });

      /*
      var optionsPanel = new Ext.Panel({
        region: 'east',
        contentEl: 'eastPanel',
        //title: 'Google Earth Options',
        //width: 200,
        border: true,
        collapsible: true,
        collapsed: true,
        margins: '5 5 5 5',
        //layout: 'vbox',
        defaultType: 'panel',
        defaults: {
          bodyStyle: 'padding: 10px'
        }
      });
      */

      // Add panels to browser viewport
      var viewport = new Ext.Viewport({
        layout: 'border',
        items: [controlPanel, earthPanel]
        //items: [controlPanel, earthPanel, optionsPanel]
      });

      // Build control panel
      earthPanel.on('earthLoaded', function(){
        // Display KMLs
        //earthPanel.fetchKml('http://earthatlas.info/kml/statistics/infant_mortality_rate_2005_prism.kmz');
        earthPanel.fetchKml('http://basementmonkeys.com/kml/core.kmz');

        // Add panels
        controlPanel.add(earthPanel.getLocationPanel());
        controlPanel.add(earthPanel.getKmlPanel());
        controlPanel.add(earthPanel.getLayersPanel());
        controlPanel.add(earthPanel.getOptionsPanel());
        controlPanel.doLayout();

        // expand the KML panel
        // hard-coded crappiness
        controlPanel.get(1).expand(false);

        /*
        optionsPanel.add(earthPanel.getOptionsPanel());
        optionsPanel.doLayout();
        */
      });
    });
  </script>
</head>

<body>
  <div id="westPanel"></div>
  <div id="centerPanel"></div>
  <!-- <div id="eastPanel"></div> -->
</body>
</html>
